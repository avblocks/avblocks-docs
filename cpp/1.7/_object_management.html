<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>AVBlocks for C++: Object Management</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="custom-doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

<script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-226295-16']);
    _gaq.push(['_trackPageview']);

    (function () {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

</script>
</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em; padding-bottom: 0.5em;">
   <div id="projectname">AVBlocks for C++
   &#160;<span id="projectnumber">1.7</span>
   </div>
   <div id="projectbrief">Audio and Video Software Development Kit</div>
   <!--<p style="color: #dc143c; font-size: 8.5pt; font-weight: bold;">[This is preliminary documentation and is subject to change.]</p>-->
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('_object_management.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Object Management </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="main_sec"></a>
Common Rules for Object Management in AVBlocks (C++)</h2>
<p>There are two distinct types of objects in AVBlocks: </p>
<ol>
<li>
Objects with reference management. They implement the <a class="el" href="classprimo_1_1_reference.html" title="Base class for all objects that require reference management.">primo::Reference</a> interface. Most objects fall into this category. </li>
<li>
Objects without reference management. They do not inherit from <a class="el" href="classprimo_1_1_reference.html" title="Base class for all objects that require reference management.">primo::Reference</a>. </li>
</ol>
<h2><a class="anchor" id="obj_ref_count"></a>
1. Objects with reference management.</h2>
<p>These objects keep an internal reference count which is controlled via the <a class="el" href="classprimo_1_1_reference.html" title="Base class for all objects that require reference management.">primo::Reference</a> interface. The count is increased via <a class="el" href="classprimo_1_1_reference.html#a32bf3bb7985194840714fbc6d737edee">Reference::retain</a> and decreased via <a class="el" href="classprimo_1_1_reference.html#a8de62834069c405b6e91b432383868b9">Reference::release</a>. By convention when an object with a reference count of 1 is released it is destroyed. As part of the destruction process the object releases all other objects that it has retained itself.</p>
<h3><a class="anchor" id="obj_create"></a>
Creating Objects</h3>
<p>An AVBlocks object is normally created with one of the AVBlocks creating functions. Those are all functions that begin with the word <em><b>create</b></em> in the C++ API (for example <a class="el" href="namespaceprimo_1_1avblocks_1_1_library.html#a926110a6e3ec665cb08e3e57ac8763a2">Library::createTranscoder</a> and <a class="el" href="classprimo_1_1avblocks_1_1_media_socket.html#a11f9171f1984989067320b82a1055731">MediaSocket::createFromPreset</a>). These C++ creating functions have equivalent C exported functions beginning with <em><b>avb_create</b></em> (for example avb_create_transcoder and avb_create_media_socket_from_preset). Another way to create new object instances is by using the <em><b>clone</b></em> method provided by some objects (like <a class="el" href="classprimo_1_1avblocks_1_1_error_info.html#a96cec1fcd0689399b86e700f0ab10772">ErrorInfo::clone</a>, <a class="el" href="classprimo_1_1codecs_1_1_stream_info.html#a0c208c52cf9c38a8154adb6ac3b0ae0a">StreamInfo::clone</a>, <a class="el" href="classprimo_1_1codecs_1_1_audio_stream_info.html#a3c78719519153a64c2012baf883bc17a">AudioStreamInfo::clone</a> and <a class="el" href="classprimo_1_1codecs_1_1_video_stream_info.html#a31694c92f0d3675445d2e7396cce95f0">VideoStreamInfo::clone</a>). An object that is created by one of the methods described above is reference counted. Its initial reference count is 1. The user code is responsible for managing such an object and it should be released when it is not needed anymore.</p>
<h3><a class="anchor" id="obj_as_parameter"></a>
Passing Objects as Function Parameters</h3>
<p>When an object is passed as a parameter to an AVBlocks function it may or may not be retained by the function. This depends on how the parameter is used in the Library and this is stated clearly in the documentation. The basic principle is that when the object will be used by AVBlocks after the function returns then it is retained by the Library (for example when a <a class="el" href="classprimo_1_1avblocks_1_1_media_pin.html">MediaPin</a> object is passed to <a class="el" href="classprimo_1_1avblocks_1_1_media_pin_list.html#a94ddcf69d463483146de454930770869">MediaPinList::add</a> it is retained since it becomes part of the list). If the passed object is used only within the function then it is not retained (for example when a <a class="el" href="classprimo_1_1codecs_1_1_media_sample.html">MediaSample</a> object is passed to <a class="el" href="classprimo_1_1avblocks_1_1_transcoder.html#abb8fa7942b3e84e0275c793dfbe2c3a0">Transcoder::push</a> it is not retained because it is used only within this method).</p>
<h4><a class="anchor" id="obj_as_return_value"></a>
Returning Objects from Functions</h4>
<p>A reference counted object can be returned either as a result of a creating operation (see <a class="el" href="_object_management.html#obj_create">Creating Objects</a> above) or because the object already exists and it is being accessed. As already mentioned when a new object is created the user code is responsible to release it when it's not needed anymore. But when a reference counted object is simply accessed the user code should not release it. It should do so only if it has previously retained the object. This is an option that can be used when the returned object must be detached from the container (for example the client code may want to keep a <a class="el" href="classprimo_1_1avblocks_1_1_media_pin.html">MediaPin</a> object even when the <a class="el" href="classprimo_1_1avblocks_1_1_media_socket.html">MediaSocket</a> that holds it is destroyed).</p>
<h2><a class="anchor" id="obj_no_ref_count"></a>
2. Objects without reference management.</h2>
<p>The objects that fall in this category cannot be created separately by the user code. They exist only in the context of another AVBlocks object and cannot be detached from it. Their lifetime depends only on the object that holds them.</p>
<p>Currently these are <a class="el" href="classprimo_1_1avblocks_1_1_media_pin_list.html">MediaPinList</a>, <a class="el" href="classprimo_1_1avblocks_1_1_media_socket_list.html">MediaSocketList</a>, <a class="el" href="classprimo_1_1codecs_1_1_meta_attribute_list.html">MetaAttribute</a> and <a class="el" href="classprimo_1_1codecs_1_1_meta_picture_list.html">MetaPictureList</a>. </p>
</div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div>
  <div id="nav-path" class="navpath">
    <ul>

    <li class="footer">
    <a href="http://primosoftware.com" target="_blank">(c) 2012 Primo Software Corporation. All rights reserved.</a>
    </li>
   </ul>
 </div>


</body>
</html>
